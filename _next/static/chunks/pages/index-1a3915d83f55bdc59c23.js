(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5405],{2853:function(e){class t{constructor({version:e="v1",inferenceInterval:t=1e4,inferenceCallback:s,captureCallback:n}){this.version=e,this.snapshotInterval=200,this.inferenceInterval=t,this.captureCallback=n,this.inferenceCallback=s,this.snapshots=[],this.currentSnapshot={},this.mouseOverWindow=!0,this.mouseClientX,this.mouseClientY,this.eventListeners=[],this.addEventListener("mousemove",this.updateMousePosition.bind(this)),this.timeStampOffset=0,this.timeLeft=0,this.history=[],this.startListening(),this.startCaptureLoop(),this.active=!0,this.startInferenceLoop(),this.loadModel()}addEventListener(e,t){this.eventListeners.push({event:e,function:t.bind(this)}),document.addEventListener(e,t)}deactivate(){for(let e=0;e<this.eventListeners.length;e++)document.removeEventListener(this.eventListeners[e].event,this.eventListeners[e].function);this.stopCaptureLoop(),this.stopInferenceLoop(),this.active=!1}generateNewSnapshot(){return Object.assign({},{alpha:[],space:[],number:[],enter:[],tab:[],arrow:[],back:[],symbol:[],scrolls:[],mousemoves:[],clicks:[],borderCrosses:[],interval:this.snapshotInterval,timeGone:0,docLength:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),width:window.innerWidth,height:window.innerHeight,scrollY:window.scrollY,mouseX:this.mouseClientX,mouseY:this.mouseClientY,mouseOverWindow:this.mouseOverWindow,creationTime:new Date})}setTimeStampOffset(e){0==this.timeStampOffset&&(this.timeStampOffset=e.timeStamp)}updateMousePosition(e){this.mouseClientX=e.clientX,this.mouseClientY=e.clientY}handleClick(e){if(this.captureLoop){this.setTimeStampOffset(e);const t=e.timeStamp-this.timeStampOffset;this.currentSnapshot.clicks.push({clientX:e.clientX,clientY:e.clientY,timeStamp:t})}}handleScroll(e){if(this.captureLoop){this.setTimeStampOffset(e);const t=e.timeStamp-this.timeStampOffset;this.currentSnapshot.scrolls.push({position:window.scrollY,timeStamp:t})}}handleKeydown(e){if(this.captureLoop){this.setTimeStampOffset(e);let{key:t}=e;const s=e.timeStamp-this.timeStampOffset;1==t.length&&t.match(/[a-z]/i)?this.currentSnapshot.alpha.push(s):" "==t?this.currentSnapshot.space.push(s):t>="0"&&t<="9"?this.currentSnapshot.number.push(s):"Enter"==t?this.currentSnapshot.enter.push(s):"Tab"==t?this.currentSnapshot.tab.push(s):e.keyCode>=37&&e.keyCode<=40?this.currentSnapshot.arrow.push(s):"Shift"==t||"CapsLock"==t||"Control"==t||"Alt"==t||"Meta"==t||("Backspace"==t?this.currentSnapshot.back.push(s):this.currentSnapshot.symbol.push(s))}}handleMousemove(e){if(this.captureLoop){this.setTimeStampOffset(e);const t=e.timeStamp-this.timeStampOffset;this.currentSnapshot.mousemoves.push({clientX:e.clientX,clientY:e.clientY,timeStamp:t})}}handleMouseleave(e){this.mouseOverWindow=!1,this.captureLoop&&(this.setTimeStampOffset(e),this.currentSnapshot.borderCrosses.push({entering:!1,timeStamp:new Date}))}handleMouseenter(e){this.mouseOverWindow=!0,this.captureLoop&&(this.setTimeStampOffset(e),this.currentSnapshot.borderCrosses.push({entering:!0,timeStamp:new Date}))}handleVisibilityChange(e){if(this.captureLoop)if(this.setTimeStampOffset(e),document.hidden)clearInterval(this.captureLoop),this.enqueueSnapshot(this.currentSnapshot),this.currentSnapshot=this.generateNewSnapshot(),this.timeLeft=new Date;else{const e=new Date-this.timeLeft;this.currentSnapshot=this.generateNewSnapshot(),this.currentSnapshot.timeGone=e,this.startCaptureLoop()}}startListening(){this.addEventListener("keydown",this.handleKeydown.bind(this)),this.addEventListener("click",this.handleClick.bind(this)),this.addEventListener("scroll",this.handleScroll.bind(this)),this.addEventListener("mouseenter",this.handleMouseenter.bind(this)),this.addEventListener("mouseleave",this.handleMouseleave.bind(this)),this.addEventListener("mousemove",this.handleMousemove.bind(this)),this.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this))}enqueueSnapshot(e){const t=this.encodeSnapshot(e);this.captureCallback&&this.captureCallback(e,t),this.snapshots.push(t)}startCaptureLoop(){this.captureFunction(),this.captureLoop=setInterval(this.captureFunction.bind(this),this.snapshotInterval)}stopCaptureLoop(){clearInterval(this.captureLoop),this.captureLoop=void 0}captureFunction(){Object.keys(this.currentSnapshot).length>0&&this.enqueueSnapshot(this.currentSnapshot),this.currentSnapshot=this.generateNewSnapshot()}encodeSnapshot(e){let t=[],s=0;for(const d of["alpha","arrow","back","enter","space","symbol","tab","number"])s+=e[d].length;t.push(s),t.push(e.clicks.length);let n=0,i=e.mouseOverWindow,o=e.creationTime.getTime();for(let d of e.borderCrosses)d.entering&&(n+=d.timeStamp.getTime()-o),o=d.timeStamp.getTime(),i=!i;i&&(n+=e.interval+e.creationTime.getTime()-o),t.push(n/e.interval);let a=0;if(e.mousemoves.length>0){let t=e.mouseX||e.mousemoves[0].clientX,s=e.mouseY||e.mousemoves[0].clientY;for(const n of e.mousemoves){const e=n.clientX,i=n.clientY;a+=(r=t,h=e,c=s,l=i,Math.sqrt(Math.pow(r-h,2)+Math.pow(c-l,2))),t=e,s=i}}var r,h,c,l;t.push(a);let u=0,p=e.scrollY;if(e.scrolls.length>0){let t=p;for(const s of e.scrolls){const e=s.position;u+=Math.abs(t-e),t=e}}return t.push(u),t.push(p),t.push(e.timeGone),t}startInferenceLoop(){this.inferenceLoop=setInterval(this.inferenceFunction.bind(this),this.inferenceInterval)}async inferenceFunction(){this.snapshots.length<this.inferenceInterval/this.snapshotInterval&&await this.sleep(this.inferenceInterval-this.snapshots.length*this.snapshotInterval);const e=this.padWithZeros(this.snapshots.slice(this.snapshots.length-Math.round(this.inferenceInterval/this.snapshotInterval)),50),t=new Date;for(;!this.model;){const e=new Date;if(t+this.inferenceInterval-e<1e3)return;await this.sleep(200)}console.log(e);const s=tf.tensor([e],[1,50,7]);s.print();const n=(await this.model.predict(s,{batchSize:1}).array())[0],i=["distracted","engaged","idle","rushed"],o=Math.max(...n);for(let a=0;a<n.length;a++)if(n[a]==o){this.history.push(i[a]),this.inferenceCallback&&this.inferenceCallback(this.history);break}}stopInferenceLoop(){clearInterval(this.inferenceLoop),this.inferenceLoop=void 0}sleep(e){return new Promise((t=>{setTimeout(t,e)}))}async loadModel(){for(;"undefined"===typeof tf;)await this.sleep(200);this.model=await tf.loadLayersModel("https://cdn.jsdelivr.net/gh/blakesanie/UX-AI@latest/site/public/models/v1/model.json")}async testModel(){const e=tf.tensor([]);await this.model.predict(e,{batchSize:1}).array()}padWithZeros(e,t){for(;e.length<t;){let t=[];for(let e=0;e<7;e++)t.push(0);e.push(t)}return e}}try{e.exports=t}catch{}},8474:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSG:function(){return v},default:function(){return b}});var n=s(5893),i=s(9008),o=s(2853),a=s.n(o),r=s(7294),h=s(3403),c=s(4417),l=s(4845),u=s(5365),p=s(5773);(new(s(3787).Converter)).setFlavor("github");var d,m=new(0,s(8086).Parser);function f(e){var t=e.children,s=e.open,i=e.value;return(0,n.jsx)(u.ZP,{open:s,enterTouchDelay:0,placement:"top",className:"rounded",title:"".concat(i).concat(1=="".concat(i).length?".0":"","s"),children:t})}var v=!0;function b(e){var t=(0,r.useState)(!1),s=t[0],o=t[1],u=(0,r.useState)(5),v=u[0],b=u[1],S=(0,r.useState)(""),g=S[0],w=S[1],L=(0,r.useState)(!1),y=L[0],k=L[1],C=function(e){k(!1),setTimeout((function(){k(!0),w(e)}),1)};return(0,r.useEffect)((function(){document.addEventListener("copy",(function(e){C("Successfully copied text")}))}),[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.default,{children:[(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=0.5"}),(0,n.jsx)("script",{src:"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js",children:" "})]}),e.elements.map((function(e,t){if("codeblock"==e.type)return(0,n.jsx)("div",{className:"codeBlock  rounded",children:(0,n.jsx)(h.Z1,{codeBlock:!0,style:{},text:e.text,language:e.language.replace("html","markup"),showLineNumbers:!1,wrapLines:!0,theme:h.Nl},t)},t);if("demo"==e.type)return(0,n.jsxs)("div",{className:"demo",children:[(0,n.jsx)("p",{children:"UX-AI is ready to run on this page! Activate UX-AI with the button below, or deactivate to adjust the inference interval. Then, try varying your behavior and observe the snackbar that appears in the lower-right corner."}),(0,n.jsx)("p",{className:"label",children:"Make inference every:"}),(0,n.jsx)(l.Z,{value:v,step:.1,ValueLabelComponent:f,min:3,max:10,style:{opacity:s?.2:1,pointerEvents:s?"none":"auto"},valueLabelDisplay:"on",onChange:function(e,t){b(t)}}),(0,n.jsx)(c.Z,{variant:"contained",size:"large",className:"rounded "+(s?"deactivate":"activate"),onClick:function(){s?(d.deactivate(),d=void 0,C("UX-AI Deactivated")):(C("UX-AI Activated"),d=new(a())({inferenceInterval:1e3*v,inferenceCallback:function(e){C('Latest behavior status: "'.concat(e[e.length-1],'"'))}})),o(!s)},children:"".concat(s?"Deactivate":"Activate"," UX-AI")}),(0,n.jsx)("p",{className:"label",children:"Resulting object instantiation:"}),(0,n.jsx)("div",{className:"codeBlock rounded",children:(0,n.jsx)(h.Z1,{text:"const uxai = new UXAI({\n\tinferenceInterval: ".concat(1e3*v,",\n\tinferenceCallback: history => {\n\t\t// do something\n\t}\n})"),language:"javascript",showLineNumbers:!1,wrapLines:!0,theme:h.Nl})})]},t);var i=m.parse(e.text);return e.text.includes("<ul")?i:(0,n.jsx)("div",{children:i},t)})),(0,n.jsx)(p.Z,{open:y,onClose:function(){k(!1)},autoHideDuration:2500,message:g,anchorOrigin:{vertical:"bottom",horizontal:"right"}},g)]})}},8581:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(8474)}])}},function(e){e.O(0,[9774,2914,2888,179],(function(){return t=8581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);